 # C++ Compiler
image:Visual Studio 2015

# Specify version format
#Latest
version: 1.0."{build}"

platform:
- Win32
- x64

# branches to build

# branches:
#  only:
 # - master
    
    
# scripts that are called at very beginning, before repo cloning
init:
  - git config --global core.autocrlf input
 
# clone directory
 clone_folder: C:\projects\cmakevisualstudio\ci  

# scripts that run after cloning repository
 install:
   - call "C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\vcvarsall.bat" x86
  
  
# scripts to run before build

 before_build:

  - cmd: cd %APPVEYOR_BUILD_FOLDER%
  - cmd: mkdir build
  - cmd: cd build
  
   # We generate project files for Visual Studio 13 only atm.  
   - cmd: if "%platform%"=="Win32" set "CMAKE_GENERATOR_NAME=Visual Studio 12 2013"  
   - cmd: if "%platform%"=="x64"   set "CMAKE_GENERATOR_NAME=Visual Studio 12 2013 Win64"   
   - cmd: cmake -G "%CMAKE_GENERATOR_NAME%" -DCMAKE_BUILD_TYPE=%configuration% ..
  
 build:
 
    project: C:\projects\cmakevisualstudio\Project1.sln  
    
    # enable MSBuild parallel builds  
    parallel: true   
    # MSBuild verbosity level (quiet|minimal|normal|detailed)  
    verbosity: normal

 # Deploy to GitHub Releases
  - provider: GitHub
    artifact: /.*\.nupkg/           # upload all NuGet packages to release assets
    draft: false
    prerelease: false
    on:
      branch: master                # release from master branch only
      appveyor_repo_tag: true       # deploy on tag push only  
    
